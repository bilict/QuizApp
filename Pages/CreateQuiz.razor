@using System.Net.Http
@using System.Net.Http.Json
@using Microsoft.AspNetCore.Components.Forms
@inject HttpClient Http

<h3>Create a New Quiz</h3>
<InputText @bind="quizTitle" placeholder="Quiz Title" />
@foreach (var question in questions)
{
    <InputText @bind="question.Text" placeholder="Question Text" />
    @for (int i = 0; i < question.Options.Count; i++)
    {
        <InputText @bind-Value="question.Options[i]" placeholder="@GetOptionPlaceholder(i)" />
        <button @onclick="() => question.CorrectOptionIndex = i">Mark as Correct</button>
    }
}
<button @onclick="AddQuestion">Add Question</button>
<button @onclick="SubmitQuiz">Submit Quiz</button>

@code {
    private string quizTitle;
    private List<Question> questions = new();

    private void AddQuestion() => questions.Add(new Question());

    private async Task SubmitQuiz()
    {
        var quiz = new Quiz { Title = quizTitle, Questions = questions };
        await Http.PostAsJsonAsync("api/quizzes", quiz);
        questions.Clear();
        quizTitle = string.Empty;
    }

    private string GetOptionPlaceholder(int index) => $"Option {index + 1}";

    public class Quiz
    {
        public string Title { get; set; }
        public List<Question> Questions { get; set; } = new();
    }

    public class Question
    {
        public string Text { get; set; }
        public List<string> Options { get; set; } = new();
        public int CorrectOptionIndex { get; set; }
    }
}