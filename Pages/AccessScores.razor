@page "/scores"
@using System.Net.Http
@using System.Net.Http.Json
@inject HttpClient Http

<h3>Your Quiz Results</h3>

@if (_scores == null)
{
    <p>Loading scores...</p>
}
else
{
    <div class="score-list">
        @foreach (var scoreGroup in _scores.GroupBy(s => s.QuizId))
        {
            <div class="score-card">
                <h5>@scoreGroup.First().Quiz.Title</h5>
                <p>Best Score: @scoreGroup.Max(s => s.Score)/@scoreGroup.First().Quiz.Questions.Count</p>
                <p>Attempts: @scoreGroup.Count()</p>
            </div>
        }
    </div>
}

@code {
    private List<UserScore> _scores = new();

    protected override async Task OnInitializedAsync()
    {
        _scores = await Http.GetFromJsonAsync<List<UserScore>>("api/quizzes/scores") ?? new List<UserScore>();
    }

    // If these are only used to deserialize data from API, you can keep them as they are.
    public class UserScore
    {
        public int QuizId { get; set; }
        public Quiz Quiz { get; set; }
        public int Score { get; set; }
    }

    public class Quiz
    {
        public int Id { get; set; }
        public string Title { get; set; } = string.Empty;
        public List<Question> Questions { get; set; } = new();
    }

    public class Question
    {
        public string Text { get; set; } = string.Empty;
    }
}